<!DOCTYPE html>
<html>
<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="[object Object]" />
  <meta name="referrer" content="unsafe-url">
  
  <title>为什么有的集群没有训练网？？</title>
  <meta name="author" content="Shuang Liang">
  <meta name="description" content="travel, life, code">
  
  
  <meta property="og:title" content="为什么有的集群没有训练网？？"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="liangshuang&#39;s blog"/>
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="liangshuang&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>

<!-- hexo injector head_end start -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4S0J2DBYMW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4S0J2DBYMW');
</script>
  <!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <a id="top"></a>
  <div id="main">
    <div class="main-ctnr">
      <div class="behind">
  <a href="/" class="back black-color">
    <svg class="i-close" viewBox="0 0 32 32" width="22" height="22" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
        <path d="M2 30 L30 2 M30 30 L2 2"></path>
    </svg>
  </a>
  
    <div class="description">
      &nbsp;supercool
    </div>
    
</div>


  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        为什么有的集群没有训练网？？
    </h1>
  


    </div>
    <div class="meta center">
      <time datetime="2025-10-25T14:13:15.000Z" itemprop="datePublished">
  <svg class="i-calendar" viewBox="0 0 32 32" width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
    <path d="M2 6 L2 30 30 30 30 6 Z M2 15 L30 15 M7 3 L7 9 M13 3 L13 9 M19 3 L19 9 M25 3 L25 9"></path>
  </svg>
  &nbsp;
  2025-10-25
</time>


    
    &nbsp;
    <svg class="i-tag" viewBox="0 0 32 32" width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      <circle cx="24" cy="8" r="2"></circle>
      <path d="M2 18 L18 2 30 2 30 14 14 30 Z"></path>
    </svg>
    &nbsp;
    <a href="/categories/人工智能杂谈/">人工智能杂谈</a>





    </div>
    <hr>
    
    <div class="picture-container">
      
    </div>
    <div style="
  border: 1px solid #ddd;        /* 边框样式 */
  padding: 10px;                 /* 内边距 */
  background-color: #f3ba2f;     /* 背景颜色 - 可修改 */
  color: #4e4e4e;                /* 文字颜色 - 可修改 */
  border-radius: 5px;            /* 圆角半径 */
  margin: 10px 0;                /* 外边距 */
">
这个问题触及了GPU集群设计中一个核心的权衡：成本与性能。
</div>

<p>简单来说，一个GPU集群没有专用的“训练网”，通常意味着它使用的是标准的以太网，而不是为高性能计算设计的专用互联网络。这背后是设计者根据工作负载类型、预算和性能需求做出的主动选择。</p>
<p>下面我们来详细拆解一下原因和场景：</p>
<h1 id="1-什么是“训练网”？"><a href="#1-什么是“训练网”？" class="headerlink" title="1. 什么是“训练网”？"></a>1. 什么是“训练网”？</h1><p>首先，我们要明确“训练网”指的是什么。在AI和高性能计算领域，它通常指代专门为大规模分布式训练设计的高速、低延迟互联技术，例如：</p>
<ul>
<li>NVIDIA NVLink &amp; NVSwitch：在单个服务器内部连接GPU，提供极高的带宽。</li>
<li>InfiniBand：在服务器之间进行通信的主流技术，提供极高的吞吐量和极低的延迟，并支持GPUDirect RDMA等技术，让GPU可以直接访问其他服务器的内存，绕过CPU和操作系统。</li>
<li>RoCE：一种基于以太网的技术，旨在在以太网上实现类似InfiniBand的性能。</li>
</ul>
<p>这些“训练网”的核心目标是：最小化GPU之间的通信时间。</p>
<h1 id="2-为什么有些集群会省去“训练网”？"><a href="#2-为什么有些集群会省去“训练网”？" class="headerlink" title="2. 为什么有些集群会省去“训练网”？"></a>2. 为什么有些集群会省去“训练网”？</h1><p>当一个集群选择只用普通以太网（比如10&#x2F;25&#x2F;100GbE）而不用InfiniBand或RoCE时，通常是基于以下几点考虑：</p>
<h2 id="a-工作负载需求：推理-vs-训练"><a href="#a-工作负载需求：推理-vs-训练" class="headerlink" title="a) 工作负载需求：推理 vs. 训练"></a>a) 工作负载需求：推理 vs. 训练</h2><ul>
<li>推理集群：推理通常是单向的——输入数据，输出结果。各个GPU节点之间几乎不需要通信。每个请求都是独立的，可以在任何一个GPU上完成。在这种情况下，花大价钱部署InfiniBand是巨大的浪费。一个高速的以太网用于数据传输和管理足矣。</li>
<li>小规模训练或微调：如果任务主要是对预训练模型进行微调，或者模型本身很小，可以塞进单个GPU服务器内（比如8卡A100&#x2F;H100服务器），那么服务器内部的NVLink已经足够。服务器之间的通信需求很低，普通以太网就能满足。</li>
</ul>
<h2 id="b-成本考量"><a href="#b-成本考量" class="headerlink" title="b) 成本考量"></a>b) 成本考量</h2><ul>
<li>硬件成本：InfiniBand的网卡、交换机的价格远高于同速率的以太网设备。</li>
<li>运维成本：InfiniBand需要更专业的知识进行配置、维护和故障排查。以太网则是每个IT工程师都熟悉的技术，运维更简单、成本更低。</li>
</ul>
<h2 id="c-模型并行度要求低"><a href="#c-模型并行度要求低" class="headerlink" title="c) 模型并行度要求低"></a>c) 模型并行度要求低</h2><p>分布式训练有两种主要方式：</p>
<ol>
<li>数据并行：每个GPU都有完整的模型副本，处理不同的数据批次，然后定期同步梯度。这会产生大量的All-Reduce通信。</li>
<li>模型并行：当模型太大，单个GPU放不下时，需要将模型的不同层拆分到不同的GPU上。这会产生大量的点对点通信。</li>
</ol>
<p>对于许多模型（尤其是几年前的主流模型），使用数据并行就足够了。虽然数据并行也需要同步梯度，但如果：</p>
<ul>
<li>模型参数量不是特别巨大（比如小于10B参数）。</li>
<li>梯度同步的频率不是瓶颈（比如计算本身很耗时）。</li>
<li>集群规模不大（比如只有几台服务器）。</li>
</ul>
<p>那么，使用高速以太网进行梯度同步带来的时间开销，在总的训练时间中占比可能可以接受。为了这点时间节省而投资昂贵的InfiniBand，投资回报率不高。</p>
<h2 id="d-历史或通用性原因"><a href="#d-历史或通用性原因" class="headerlink" title="d) 历史或通用性原因"></a>d) 历史或通用性原因</h2><ul>
<li>“顺便”搭建的GPU集群：有些机构可能是在已有的、用于通用计算的高性能计算集群上，“顺便”增加了一些GPU节点。这个集群原本就是基于以太网设计的，没有为AI训练专门升级网络。</li>
<li>多用途集群：集群可能同时服务于AI训练、科学计算、大数据处理等多种任务。并非所有任务都需要超低延迟网络，因此选择了性价比更高的以太网作为统一的网络架构。</li>
</ul>
<p>总结：有无“训练网”的典型场景对比</p>
<div style="font-size: 14px;width:100%;overflow-x:auto;">

<table style="width:700px;">
  <tr>
    <td>

<table>
<thead>
<tr>
<th align="center">特征</th>
<th align="center">有“训练网”的集群</th>
<th align="center">无“训练网”的集群</th>
</tr>
</thead>
<tbody><tr>
<td align="center">核心网络</td>
<td align="center">InfiniBand, RoCE</td>
<td align="center">标准以太网</td>
</tr>
<tr>
<td align="center">目标工作负载</td>
<td align="center">大规模分布式训练（尤其是LLM、科学计算）</td>
<td align="center">标准推理、小规模训练、微调、通用计算以太网</td>
</tr>
<tr>
<td align="center">通信模式</td>
<td align="center">密集型All-Reduce，频繁的点对点通信</td>
<td align="center">稀疏通信，或仅在检查点时同步</td>
</tr>
<tr>
<td align="center">模型大小</td>
<td align="center">超大模型（数十亿至万亿参数）</td>
<td align="center">中小型模型</td>
</tr>
<tr>
<td align="center">并行策略</td>
<td align="center">大规模数据并行、必须的模型&#x2F;流水线并行</td>
<td align="center">小规模数据并行，或无需分布式</td>
</tr>
<tr>
<td align="center">成本</td>
<td align="center">非常高</td>
<td align="center">相对低廉</td>
</tr>
<tr>
<td align="center">典型用户</td>
<td align="center">大型科技公司、顶级研究机构、云服务商</td>
<td align="center">中小企业、高校实验室、初创公司</td>
</tr>
</tbody></table>
  </tr>
</table>

</div>


<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>所以，当你看到一个GPU集群没有配备“训练网”时，这通常不是一个错误，而是一个符合其定位的、合理的工程设计选择。它精准地服务于推理、小规模训练或对通信不敏感的工作负载，并在满足性能要求的同时，实现了成本效益的最大化。<br>对于立志于训练下一代万亿参数大模型的企业，投资InfiniBand是必须的。但对于90%以上的AI应用场景，一个设计良好的以太网GPU集群已经绰绰有余。</p>
<div style="margin: 40px 0; overflow: hidden;">
  <div style="
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: flex-start;
    align-items: center;
  ">
    <div style="flex: 1 0 100px; max-width: 120px; min-width: 80px;">
      <img src="https://cdn.jsdelivr.net/gh/supercooledith/website_picture@main/Written-By-Human-Not-By-AI-Badge-white%402x.png" 
           alt="真人撰写 非AI生成" 
           style="width: 100%; height: auto; display: block;">
    </div>
    <div style="flex: 1 0 100px; max-width: 120px; min-width: 80px;">
      <img src="https://cdn.jsdelivr.net/gh/supercooledith/website_picture@main/Written-By-Humans-Not-By-AI-Badge-white%402x.png" 
           alt="written by humans not by AI" 
           style="width: 100%; height: auto; display: block;">
    </div>
    <div style="flex: 1 0 100px; max-width: 120px; min-width: 80px;">
      <img src="https://cdn.jsdelivr.net/gh/supercooledith/website_picture@main/Japanese_Written-By-Human-Not-By-AI-Badge-white%402x.png" 
           alt="AIではなく人間が書いた" 
           style="width: 100%; height: auto; display: block;">
    </div>
  </div>
</div>

  </article>
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <div class="busuanzi center">
    <span id="busuanzi_container_page_pv">
      本文阅读量：<span id="busuanzi_value_page_pv"></span> 次
    </span>
    <span id="busuanzi_container_site_pv">
      本站总访问量：<span id="busuanzi_value_site_pv"></span> 次
    </span>
    <span id="busuanzi_container_site_uv">
      本站访客数：<span id="busuanzi_value_site_uv"></span> 人
    </span>
  </div>

<!-- 
    
        <div id="disqus_thread"></div>
        <script>

        var disqus_config = function () {
        this.page.url = 'http://example.com/2025/10/25/whynotrainnet/index.html';
        this.page.identifier = ;
        };

        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//supercool-2.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
        </script>
    
 -->


    <div id="disqus_thread"></div>
    <script>
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://supercool-2.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


 <!-- 
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'http://example.com/2025/10/25/whynotrainnet/';
            this.page.identifier = '2025/10/25/whynotrainnet/';
            this.page.title = '为什么有的集群没有训练网？？';
        };
        
        (function() {
            var d = document, s = d.createElement('script');
            s.src = 'https://supercool-2.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>请启用JavaScript查看<a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">Disqus评论</a></noscript>
 -->


    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot">
    <div class="firstrow">
        <a href="#top" target="_self">
        <svg class="i-caret-right" viewBox="0 0 32 32" width="24" height="24" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
            <path d="M10 30 L26 16 10 2 Z"></path>
        </svg>
        </a>
        liangshuang 1999-2025
    </div>
    <div class="secondrow">
        <a target="_blank" rel="noopener" href="https://github.com/supercooledith">
        supercool
        </a>
    </div>
</div>
<div class="clearfix">
</div>
</footer>
  <script type="text/javascript">

// disqus scripts

var disqus_shortname = 'supercool-2';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('body')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());


// dropdown scripts
function $(s) {
    return document.querySelector(s)
  }

  function $$(s) {
    return document.querySelectorAll(s)
  }
  var dropDownElArr = $$('.dropdown')
  for (var i = 0; i < dropDownElArr.length; i += 1) {
    dropDownElArr[i].addEventListener('click', function(event) {
      var content = this.querySelector('.dropdown-content')
      event.stopPropagation()
      if (content.className.indexOf('open') < 0) {
        content.classList.add('open')
      } else {
        content.classList.remove('open')
      }
    })
  }
  document.body.addEventListener('click', function() {
    var dropDownContentElArr = $$('.dropdown-content')
    for (var i = 0; i < dropDownContentElArr.length; i += 1) {
      dropDownContentElArr[i].classList.remove('open')
    }
  })

  // smooth scroll
  $$('a[href^="#"]').forEach(e=>{
    e.addEventListener("click", function(e) {
      e.preventDefault();
      var t = this.getAttribute("href").substr(1);
      $(`[id='${decodeURIComponent(t)}']`).scrollIntoView({
        behavior: "smooth"
      }),
      t === "top" ? history.replaceState(null, null, " ") : history.pushState(null, null, `#${t}`)
    })
  })

// search
var searchEl = document.querySelector("#local-search-input")
if (searchEl) searchEl.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    var s = e.target.value
    window.open('//www.google.com/search?q=site:http://example.com%20' + s, '_blank').focus()
  }
})

</script>

</body>
</html>
